<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>kmp初识 | Outing myself</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="[object Object]"><meta name="designer" content="minfive"><meta name="keywords" content="null"><meta name="description" content="日常学习"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="https://github.com/BUGIsOne/2019/09/17/kmp/index.html"><link rel="icon" type="image/png" href="../images/164009528604.jpg" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="Rakel's bolg"><link rel="stylesheet" href="/scss/views/page/post.css"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(https://blog.static.minfive.com/other/loader.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="Rakel's bolg" alt="Rakel's bolg"><img src="../images/164009528604.jpg" alt="Rakel's bolg"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="首页" title="首页">首页</a></li><li class="nav__item"><a href="/archives" alt="归档" title="归档">归档</a></li><li class="nav__item"><a href="/about" alt="关于" title="关于">关于</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="../images/wallhaven-p8w2x3.jpg" alt="kmp初识"></div><header class="post__info"><h1 class="post__title">kmp初识</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="https://www.github.com/BUGIsOne">Rakel</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2019-09-17</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/kmp/">Kmp</a></li></ul></div></div></header><div class="post__content"><h1 id="kmp算法"><a href="#kmp算法" class="headerlink" title="kmp算法"></a>kmp算法</h1><p>参考博客（知乎–海纳）：<a href="https://www.zhihu.com/question/21923021/answer/281346746" target="_blank" rel="noopener">https://www.zhihu.com/question/21923021/answer/281346746</a></p><h2 id="1-1"><a href="#1-1" class="headerlink" title="1.1"></a>1.1</h2><p>了解kmp首先了解PMT，PMT中的值是字符串的前缀集合与后缀集合的交集中最长元素的长度。<br>例如：有个字符串：abababca</p><table><thead><tr><th>PMT</th><th>0</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>0</th><th>1</th></tr></thead><tbody><tr><td>index:</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td></tr><tr><td>value:</td><td>a</td><td>b</td><td>a</td><td>b</td><td>a</td><td>b</td><td>c</td><td>a</td></tr></tbody></table><p>为了加快查找速度，设置next数组。假设目标字符串：ababababca，模式子串：abababca，我们要返回匹配的开头下标，若不能匹配则返回 -1。</p><h2 id="1-2-next数组的创建"><a href="#1-2-next数组的创建" class="headerlink" title="1.2 next数组的创建"></a>1.2 next数组的创建</h2><p>0123456789<br><br>ababab<u>a</u>bca<br><br>ababab<u>c</u>a</p><p>i:目标字符串最新一轮没匹配的位置<br><br>j:模式字符串最新一轮没匹配的位置<br><br>如上面的第一轮 i = 6，j = 6；<br><br><br>目标字符串的第 i-j 位，到 i-1 一定与模式字符串的第 0 到 j-1 位相同。又由PMT的性质，知道模式字符串 j 前 PMT[j-1] 位分别与目标字符串 i-j 位到 i-j+PMT[j-1]-1 位（设为情况①），及 i-1-PMT[j-1]+1 位 到 i 位（设为情况②）相同。<br><br><br><br>（这是给以后没耐心的自己看的）：<br><br></p><ul><li>其实不要看公式绕自己，为了知道跳过不再比较的字符数 x，PMT 不是把现在至少匹配的字符串分成相同的前半段和后半段嘛（设这字符串为 str）。<br><br><br>通过现在至少匹配的下标 j-1 = 5，str 的长度为 6（ababab），PMT(j) = PMT(5) = 4（str[0]-str[3] 等于 str[2]-str[5] 由于目标字符串前者已被否定，所以要找后半段），x = 6 - 4 = 2。<br><br><br>好，这时候（心里面）假设目标字符串(排除前两位) i 置2，模式字符串的 j 重新置 0。那得到 str 的后半段是不是就和模式字符串 0-3 位相同。i = 2+4=6，i = 6 （ i 虽然还是 6，但要知道，它还有所动作）；j 就因为模式字符串匹配 4 位，所以 j = 4。<br></li></ul><p>0 1 2 3 4 5 6 7 8 9 (index)<br><br>a b a b a b <u>a</u> b c a<br><br>–&gt; a b a b <u>a</u> b c a</p><h2 id="1-3-总结一下"><a href="#1-3-总结一下" class="headerlink" title="1.3 总结一下"></a>1.3 总结一下</h2><p>要理解 i 与 j 失配，如何找到下一个未知的待匹配位置。正向理解就是例子中，我知道第一个 a 不是目标返回值，那我要找到下一个 a 的位置，再不行再下一个 a 的位置。而 PMT 不只帮我找下一个 a，连带着还能帮我找跟着 a 的下一个 b……甚至是帮我在上一个不尽如人意的结构下，找到下一个最多匹配个数（小于那个不尽如人意结果的字符数）的子串开头位置，让我不用再比较它们，还是继续在目标字串那个待匹配位置继续。<br>至于为什么是让 j 回到 PMT[j-1] 这个值，<strong>就是情况①不行，来试情况②</strong>，只不过目标字串 i 不变，变 j 而已。既然这两个串前 j 位都相同，变 i 变 j 意义都一样，但就”目标”嘛，是等着的那位。</p><table><thead><tr><th>char</th><th>a</th><th>b</th><th>a</th><th>b</th><th>a</th><th>b</th><th>c</th><th>a</th></tr></thead><tbody><tr><td>index</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td></tr><tr><td>PMT</td><td>0</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>0</td><td>1</td></tr><tr><td>next</td><td>-1</td><td>0</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>0</td></tr></tbody></table><p>(next[0] = -1只是为了编程的方便)</p><h2 id="2-1-kmp代码："><a href="#2-1-kmp代码：" class="headerlink" title="2.1 kmp代码："></a>2.1 kmp代码：</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">KMP</span><span class="params">(<span class="keyword">char</span> * t, <span class="keyword">char</span> * p)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">memset</span>(next, <span class="number">0</span>, <span class="keyword">sizeof</span>(next));</span><br><span class="line">	get_next(p, next);</span><br><span class="line">	<span class="keyword">while</span> (i &lt; <span class="built_in">strlen</span>(t) &amp;&amp; j &lt; <span class="built_in">strlen</span>(p))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (j == <span class="number">-1</span> || t[i] == p[j]) </span><br><span class="line">		&#123;</span><br><span class="line">			i++;</span><br><span class="line">			j++;</span><br><span class="line">		&#125;</span><br><span class="line">	 	<span class="keyword">else</span></span><br><span class="line">			j = next[j];</span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (j == <span class="built_in">strlen</span>(p))</span><br><span class="line">       <span class="keyword">return</span> i - j;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-2-快速求得next数组"><a href="#2-2-快速求得next数组" class="headerlink" title="2.2 快速求得next数组"></a>2.2 快速求得next数组</h2><p>首先说明next[j]表示j位不匹配，回到的下标值。（至于当时的人为什么想到用这种程序写法，我想了蛮久）因为0位固定死了就是-1，那从1位开始。明确next[j]表示PMT[j-1]。以模式字符串为目标字串，但开头是原模式字串第1位开始（例子的abababca的新目标字串就是bababca），能匹配的最长长度构成此目标字串的PMT,即当前位置的next值。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_next</span><span class="params">(<span class="keyword">char</span>* p, <span class="keyword">int</span>* next)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">0</span>, j=<span class="number">-1</span>;</span><br><span class="line">	next[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">while</span>(i != <span class="built_in">strlen</span>(p))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(j==<span class="number">-1</span> || p[i]==p[j])</span><br><span class="line">		&#123;</span><br><span class="line">			j++;</span><br><span class="line">			i++;</span><br><span class="line">			next[i] = j;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			j=next[j];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="post-announce">感谢您的阅读，本文由 <a href="https://github.com/BUGIsOne">Rakel's bolg</a> 版权所有。如若转载，请注明出处：Rakel's bolg（<a href="https://github.com/BUGIsOne/2019/09/17/kmp/">https://github.com/BUGIsOne/2019/09/17/kmp/</a>）</div><div class="post__prevs"><div class="post__prev"></div><div class="post__prev post__prev--right"><a href="/2019/09/17/blog搭建笔记/" title="skapp 主题博客搭建笔记">skapp 主题博客搭建笔记<i class="iconfont icon-next"></i></a></div></div></div></article></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">简介</h3><p class="block__text">日常学习</p></div><div class="sidebar__block"><h3 class="block__title">文章分类</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/os/">os</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/html/">html</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/c/">c++</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/algorithm/">algorithm</a><span class="block-list-count">1</span></li></ul></div><div class="sidebar__block"><h3 class="block__title">最新文章</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2019/09/17/hello-world/" title="hello, world"><div class="item__cover"><img src="../images/wallhaven-p8w2x3.jpg" alt="hello, world"></div><div class="item__info"><h3 class="item__title">hello, world</h3><span class="item__text">2019-09-17</span></div></a></li><li class="latest-post-item"><a href="/2019/09/17/Linux基本命令手册/" title="linux基本命令手册"><div class="item__cover"><img src="../images/wallhaven-p8w2x3.jpg" alt="linux基本命令手册"></div><div class="item__info"><h3 class="item__title">linux基本命令手册</h3><span class="item__text">2019-09-17</span></div></a></li><li class="latest-post-item"><a href="/2019/09/17/c++基础语法学习/" title="c++基础语法学习"><div class="item__cover"><img src="../images/wallhaven-p8w2x3.jpg" alt="c++基础语法学习"></div><div class="item__info"><h3 class="item__title">c++基础语法学习</h3><span class="item__text">2019-09-17</span></div></a></li><li class="latest-post-item"><a href="/2019/09/17/blog搭建笔记/" title="skapp 主题博客搭建笔记"><div class="item__cover"><img src="../images/wallhaven-p8w2x3.jpg" alt="skapp 主题博客搭建笔记"></div><div class="item__info"><h3 class="item__title">skapp 主题博客搭建笔记</h3><span class="item__text">2019-09-17</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">文章标签</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/blog/">blog</a></li><li class="tag-item"><a class="tag-link" href="/tags/kmp/">kmp</a></li><li class="tag-item"><a class="tag-link" href="/tags/linux/">linux</a></li><li class="tag-item"><a class="tag-link" href="/tags/语法/">语法</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">关于</h3><div class="item__content"><p class="item__text">本站是基于 Hexo 搭建的静态资源博客，主要用于分享日常学习、生活及工作的一些心得总结</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Chengdu, Sichuan Province, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>937459807@qq.com</span></li></ul></div></div><div class="footer-top__item footer__image"><img src="../images/IMG_20190917_184101.png" alt="logo" title="Rakel's bolg"></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">© <a href="https://github.com/Mrminfive/hexo-theme-skapp" target="_blank">Skapp</a> 2017 powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, made by <a href="https://github.com/Mrminfive" target="_blank">minfive</a>.</p><ul class="footer__social-network clearfix"><li class="social-network__item"><a href="https://github.com/BUGIsOne" target="_blank" title="github"><i class="iconfont icon-github"></i></a></li><li class="social-network__item"><a href="mailto:937459807@qq.com" target="_blank" title="email"><i class="iconfont icon-email"></i></a></li></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>